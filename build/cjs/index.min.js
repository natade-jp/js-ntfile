'use strict';

var fs = require('fs');
var child_process = require('child_process');

var NTFile=function(){};NTFile.saveTextFile=function(e,i){fs.writeFileSync(e,i,"utf-8");},NTFile.saveTextFileWithBOM=function(e,i){i.length>0&&"\ufeff"!==i.charAt(0)?fs.writeFileSync(e,"\ufeff"+i,"utf-8"):fs.writeFileSync(e,i,"utf-8");},NTFile.loadTextFile=function(e){var i=fs.readFileSync(e,"utf-8");return i.length>0&&"\ufeff"===i.charAt(0)?i.substring(1):i},NTFile.saveBinaryFile=function(e,i){for(var r=new Uint8Array(i.length),t=0;t<r.length;t++)r[t]=i[t];fs.writeFileSync(e,r);},NTFile.loadBinaryFile=function(e){for(var i=fs.readFileSync(e),r=new Array(i.length),t=0;t<i.length;t++)r[t]=i.readUInt8(t);return r},NTFile.exec=function(e){(0, child_process.execSync)(e);},NTFile.isExist=function(e){try{return fs.statSync(e),!0}catch(e){if("ENOENT"===e.code)return !1;console.log(e);}return !1},NTFile.isFile=function(e){return !!NTFile.isExist(e)&&fs.statSync(e).isFile()},NTFile.isDirectory=function(e){return !!NTFile.isExist(e)&&fs.statSync(e).isDirectory()},NTFile.copy=function(e,i){var r=fs.readFileSync(e);fs.writeFileSync(i,r);},NTFile.deleteFile=function(e){NTFile.isExist(e)&&fs.unlinkSync(e);},NTFile.makeDirectory=function(e){NTFile.isExist(e)||fs.mkdirSync(e);},NTFile.createList=function(e){if("string"==typeof e){for(var i=e.replace(/[\\/]+$/,""),r=fs.readdirSync(i),t=[],n=0;n<r.length;n++)t[n]=i+"/"+r[n];for(var l=0;l<t.length;l++)if(NTFile.isDirectory(t[l]))for(var f=fs.readdirSync(t[l]),c=0;c<f.length;c++){var s=t[l]+"/"+f[c];t.push(s);}return t}var a=e,o=NTFile.createList(a.source),F=[];for(var u in o){var T=!1;if(a.includes)for(var N in a.includes)if(new RegExp(a.includes[N]).test(o[u])){T=!0;break}if(T){if(a.excludes)for(var y in a.excludes)if(new RegExp(a.excludes[y]).test(o[u])){T=!1;break}T&&F.push(o[u]);}}return F},NTFile.deleteDirectory=function(e){if(NTFile.isDirectory(e)){for(var i=NTFile.createList(e),r=0;r<i.length;r++)NTFile.isFile(i[r])&&NTFile.deleteFile(i[r]);for(var t=0;t<10;t++)for(var n=NTFile.createList(e),l=0;l<n.length;l++)0===NTFile.createList(n[l]).length&&fs.rmdirSync(n[l]);fs.rmdirSync(e);}},NTFile.getEnvironmentFile=function(e){for(var i=NTFile.loadTextFile(e).split(/\r?\n/g),r={},t=0;t<i.length;t++){var n=i[t];if(0!==(n=n.replace(/#.*/,"").trim()).length&&/=/.test(n)){var l=n.replace(/=.*/,"").trim(),f=n.replace(/[^=]+=/,"").trim();/^".*"$/.test(f)&&(f=f.replace(/^"(.*)"$/,"$1")),r[l]=f;}}return r};

module.exports = NTFile;
