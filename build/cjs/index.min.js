'use strict';

var fs = require('fs');
var child_process = require('child_process');

var NTFile=function(){};NTFile.saveTextFile=function(e,i){fs.writeFileSync(e,i,"utf-8");},NTFile.saveTextFileWithBOM=function(e,i){i.length>0&&"\ufeff"!==i.charAt(0)?fs.writeFileSync(e,"\ufeff"+i,"utf-8"):fs.writeFileSync(e,i,"utf-8");},NTFile.loadTextFile=function(e){var i=fs.readFileSync(e,"utf-8");return i.length>0&&"\ufeff"===i.charAt(0)?i.substring(1):i},NTFile.saveBinaryFile=function(e,i){for(var r=new Uint8Array(i.length),t=0;t<r.length;t++)r[t]=i[t];fs.writeFileSync(e,r);},NTFile.loadBinaryFile=function(e){for(var i=fs.readFileSync(e),r=new Array(i.length),t=0;t<i.length;t++)r[t]=i.readUInt8(t);return r},NTFile.exec=function(e){(0, child_process.execSync)(e);},NTFile.isExist=function(e){try{return fs.statSync(e),!0}catch(e){if("ENOENT"===e.code)return !1;console.log(e);}return !1},NTFile.isFile=function(e){return !!NTFile.isExist(e)&&fs.statSync(e).isFile()},NTFile.isDirectory=function(e){return !!NTFile.isExist(e)&&fs.statSync(e).isDirectory()},NTFile.copy=function(e,i){var r=fs.readFileSync(e);fs.writeFileSync(i,r);},NTFile.deleteFile=function(e){NTFile.isExist(e)&&fs.unlinkSync(e);},NTFile.makeDirectory=function(e){NTFile.isExist(e)||fs.mkdirSync(e);},NTFile.createList=function(e,i){for(var r=e.replace(/[\\/]+$/,""),t=fs.readdirSync(r),n=[],l=0;l<t.length;l++)n[l]=r+"/"+t[l];for(var f=0;f<n.length;f++)if(NTFile.isDirectory(n[f]))for(var s=fs.readdirSync(n[f]),c=0;c<s.length;c++){var a=n[f]+"/"+s[c];n.push(a);}if(null==i)return n;var o=[];for(var F in n){var u=n[F],T=!1;if(i.includes)for(var y in i.includes){var N=i.includes[y];if("string"==typeof N){if(-1===u.indexOf(N)){T=!0;break}}else if(N.test(u)){T=!0;break}}if(T){if(i.excludes)for(var d in i.excludes){var v=i.excludes[d];if("string"==typeof v){if(-1===u.indexOf(v)){T=!1;break}}else if(v.test(u)){T=!1;break}}T&&o.push(u);}}return o},NTFile.deleteDirectory=function(e){if(NTFile.isDirectory(e)){for(var i=NTFile.createList(e),r=0;r<i.length;r++)NTFile.isFile(i[r])&&NTFile.deleteFile(i[r]);for(var t=0;t<10;t++)for(var n=NTFile.createList(e),l=0;l<n.length;l++)0===NTFile.createList(n[l]).length&&fs.rmdirSync(n[l]);fs.rmdirSync(e);}},NTFile.getEnvironmentFile=function(e){for(var i=NTFile.loadTextFile(e).split(/\r?\n/g),r={},t=0;t<i.length;t++){var n=i[t];if(0!==(n=n.replace(/#.*/,"").trim()).length&&/=/.test(n)){var l=n.replace(/=.*/,"").trim(),f=n.replace(/[^=]+=/,"").trim();/^".*"$/.test(f)&&(f=f.replace(/^"(.*)"$/,"$1")),r[l]=f;}}return r};

module.exports = NTFile;
